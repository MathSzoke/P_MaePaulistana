@page "/newPatient"
@model NewPatient

<link rel="stylesheet" href="~/css/new-patient.css" asp-append-version="true" />

<div class="body-new-register">
	<div class="container-one-new-register">
		<div class="content-ipt">
			<label for="name" class="label-column unselectable"><span class="required">*</span>Nome:</label><input type="text" name="" id="" class="ipt-name" placeholder="Nome Completo" name" required>
		</div>
		<div class="content-ipt">
			<label for="birth-date" class="label-column unselectable">
				<span class="required">*</span>Data
				nascimento:
			</label><input type="date" birthDate" required class="ipt-birth-date">
		</div>
		<div class="content-ipt">
			<label for="unit" class="label-column unselectable"><span class="required">*</span>Unidade:</label>
			<select name="unit" class="select-units" unit" required>
				<option selected value="null">Selecionar</option>
				<option value="Unidade A">Unidade A</option>
				<option value="Unidade B">Unidade B</option>
				<option value="Unidade C">Unidade C</option>
				<option value="Unidade D">Unidade D</option>
			</select>
		</div>
		<div class="content-ipt">
			<label for="attendant-type" class="label-column unselectable">
				<span class="required">*</span>Tipo
				atendimento:
			</label>
			<select name="attendant-type" class="select-attendant-types" placeholder="Selecionar" required>
				<option value="null" selected>Selecionar</option>
				<option value="Tipo 1">Tipo 1</option>
				<option value="Tipo 2">Tipo 2</option>
				<option value="Tipo 3">Tipo 3</option>
			</select>
		</div>
		<div class="content-ipt qualification-citizen">
			<label class="label-column unselectable"><span class="required">*</span>Qualificação da munícipe:</label>
			<div class="container-ipt-radio">
				<div class="area-ipt-radio">
					<label class="checkbox-label unselectable">
						<input type="radio" id="gestante" value="Gestante" name="qualificationCitizen" onchange="updateQualificationCitizen('Gestante')">
						Gestante
					</label>
				</div>
				<div class="area-ipt-radio">
					<label class="checkbox-label unselectable">
						<input type="radio" id="puerpera" value="Puerpera" name="qualificationCitizen" onchange="updateQualificationCitizen('Puerpera')">
						Puérpera
					</label>
				</div>
				<div class="area-ipt-radio">
					<label class="checkbox-label unselectable">
						<input type="radio" id="rn" value="RN" name="qualificationCitizen" onchange="updateQualificationCitizen('RN')" />
						RN
					</label>
				</div>
			</div>
		</div>
	</div>

	<div class="container-two-new-register">
		<div class="content-ipt">
			<label for="cpf" class="label-column unselectable"><span class="required">*</span>CPF:</label><input type="number" class="ipt-cpf no-spinners" placeholder="123.456.789-10" required />
		</div>
		<div class="content-ipt">
			<label for="cns" class="label-column unselectable"><span class="required">*</span>CNS:</label><input type="number" class="ipt-cns no-spinners" placeholder="123 4567 8901 2345" required />
		</div>
		<div class="content-ipt">
			<label for="dum" class="label-column unselectable"><span class="required">*</span>DUM:</label><input type="date" class="ipt-dum" required />
		</div>
		<div class="content-ipt">
			<label for="name" class="label-column unselectable"><span class="required">*</span>Previsão parto:</label><input type="date" class="ipt-prevision-forecast" required />
		</div>
	</div>
</div>


<div class="register-telephone">
	<div class="modal-header header-telephone">
		<span class="title-table-data">
			<h3 class="unselectable">Cadastrar telefones</h3>
		</span>
	</div>
	<div class="div-table-telephone">
		<table class="table-data new-telephones" id="new-rows">
			<thead>
				<tr class="row-data">
					<th class="column-data unselectable"></th>
					<th class="column-data unselectable">Telefone</th>
					<th class="column-data unselectable">Tipo</th>
					<th class="column-data unselectable">Observações</th>
				</tr>
			</thead>
			<tbody class="new-rows-added">
			</tbody>
			<tbody>
				<tr class="row-data">
					<td class="data-cell">
						<div class="contents-details-person">
							<div class="eye-data">
								<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" class="bi bi-eye-fill" viewBox="0 0 16 16">
									<path d="M10.5 8a2.5 2.5 0 1 1-5 0 2.5 2.5 0 0 1 5 0z" />
									<path d="M0 8s3-5.5 8-5.5S16 8 16 8s-3 5.5-8 5.5S0 8 0 8zm8 3.5a3.5 3.5 0 1 0 0-7 3.5 3.5 0 0 0 0 7z" />
								</svg>
							</div>
							<div class="register-call-data">
								<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" class="bi bi-telephone" viewBox="0 0 16 16">
									<path d="M3.654 1.328a.678.678 0 0 0-1.015-.063L1.605 2.3c-.483.484-.661 1.169-.45 1.77a17.568 17.568 0 0 0 4.168 6.608 17.569 17.569 0 0 0 6.608 4.168c.601.211 1.286.033 1.77-.45l1.034-1.034a.678.678 0 0 0-.063-1.015l-2.307-1.794a.678.678 0 0 0-.58-.122l-2.19.547a1.745 1.745 0 0 1-1.657-.459L5.482 8.062a1.745 1.745 0 0 1-.46-1.657l.548-2.19a.678.678 0 0 0-.122-.58L3.654 1.328zM1.884.511a1.745 1.745 0 0 1 2.612.163L6.29 2.98c.329.423.445.974.315 1.494l-.547 2.19a.678.678 0 0 0 .178.643l2.457 2.457a.678.678 0 0 0 .644.178l2.189-.547a1.745 1.745 0 0 1 1.494.315l2.306 1.794c.829.645.905 1.87.163 2.611l-1.034 1.034c-.74.74-1.846 1.065-2.877.702a18.634 18.634 0 0 1-7.01-4.42 18.634 18.634 0 0 1-4.42-7.009c-.362-1.03-.037-2.137.703-2.877L1.885.511z" />
								</svg>
							</div>
						</div>
					</td>
					<td class="data-cell td-customize-table">
						<input type="tel" class="ipt-telephone customize-table-ipt" minlength="10" maxlength="11" placeholder="(11) 9 1234-5678" required>
					</td>
					<td class="data-cell td-customize-table">
						<select name="type-telephone" id="selectTypeTel" class="select-type-telephone customize-table-ipt" required>
							<option value="null" selected>Selecionar</option>
							<option value="'Residencial'">Residencial</option>
							<option value="'Celular'">Celular</option>
							<option value="'Recado'">Recado</option>
						</select>
					</td>
					<td class="data-cell td-customize-table">
						<textarea rows="4" cols="50" class="ipt-obs customize-table-ipt" id="textareaObs" style='height: 80px;' placeholder="Observações aqui"></textarea>
					</td>
					<td colspan="5" style="border: none !important;">
						<div class="area-to-add-telephone">
							<button class="btn" type="submit" id="add-phone-button" onclick="addNewTelephone()">
								<svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" fill="currentColor" class="bi bi-node-plus" viewBox="0 0 16 16">
									<path fill-rule="evenodd" d="M11 4a4 4 0 1 0 0 8 4 4 0 0 0 0-8zM6.025 7.5a5 5 0 1 1 0 1H4A1.5 1.5 0 0 1 2.5 10h-1A1.5 1.5 0 0 1 0 8.5v-1A1.5 1.5 0 0 1 1.5 6h1A1.5 1.5 0 0 1 4 7.5h2.025zM11 5a.5.5 0 0 1 .5.5v2h2a.5.5 0 0 1 0 1h-2v2a.5.5 0 0 1-1 0v-2h-2a.5.5 0 0 1 0-1h2v-2A.5.5 0 0 1 11 5zM1.5 7a.5.5 0 0 0-.5.5v1a.5.5 0 0 0 .5.5h1a.5.5 0 0 0 .5-.5v-1a.5.5 0 0 0-.5-.5h-1z" />
								</svg>
							</button>
						</div>
					</td>
				</tr>
			</tbody>
		</table>
	</div>
</div>

<script>
	function addNewTelephone()
	{
		// Armazenar os valores antes de limpar os campos
		var telephones = [];
		// Captura os valores dos campos
		var telephoneValue = document.querySelector("#add-phone-button").closest("tr").querySelector(".ipt-telephone").value;
		var typeValue = document.querySelector("#add-phone-button").closest("tr").querySelector(".select-type-telephone").value;
		typeValue = typeValue.slice(1, -1);
		var obsValue = document.querySelector("#add-phone-button").closest("tr").querySelector(".ipt-obs").value;

		if (telephoneValue === "" || telephoneValue === null || typeValue === "" || typeValue === null)
			return;

		// Cria um novo elemento tr com os valores capturados
		var newRow = document.createElement("tr");
		newRow.classList.add("row-data");

		newRow.innerHTML = `
				<td class="data-cell">
					<div class="contents-details-person">
						<div class="eye-data">
							<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" class="bi bi-eye-fill" viewBox="0 0 16 16">
								<path d="M10.5 8a2.5 2.5 0 1 1-5 0 2.5 2.5 0 0 1 5 0z" />
								<path d="M0 8s3-5.5 8-5.5S16 8 16 8s-3 5.5-8 5.5S0 8 0 8zm8 3.5a3.5 3.5 0 1 0 0-7 3.5 3.5 0 0 0 0 7z" />
							</svg>
						</div>
						<div class="register-call-data">
							<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" class="bi bi-telephone" viewBox="0 0 16 16">
								<path d="M3.654 1.328a.678.678 0 0 0-1.015-.063L1.605 2.3c-.483.484-.661 1.169-.45 1.77a17.568 17.568 0 0 0 4.168 6.608 17.569 17.569 0 0 0 6.608 4.168c.601.211 1.286.033 1.77-.45l1.034-1.034a.678.678 0 0 0-.063-1.015l-2.307-1.794a.678.678 0 0 0-.58-.122l-2.19.547a1.745 1.745 0 0 1-1.657-.459L5.482 8.062a1.745 1.745 0 0 1-.46-1.657l.548-2.19a.678.678 0 0 0-.122-.58L3.654 1.328zM1.884.511a1.745 1.745 0 0 1 2.612.163L6.29 2.98c.329.423.445.974.315 1.494l-.547 2.19a.678.678 0 0 0 .178.643l2.457 2.457a.678.678 0 0 0 .644.178l2.189-.547a1.745 1.745 0 0 1 1.494.315l2.306 1.794c.829.645.905 1.87.163 2.611l-1.034 1.034c-.74.74-1.846 1.065-2.877.702a18.634 18.634 0 0 1-7.01-4.42 18.634 18.634 0 0 1-4.42-7.009c-.362-1.03-.037-2.137.703-2.877L1.885.511z" />
							</svg>
						</div>
					</div>
				</td>
				<td class="data-cell td-customize-new">
					<input type="tel" class="ipt-telephone customize-table-ipt unselectable" disabled value="${telephoneValue}" />
				</td>
				<td class="data-cell td-customize-new">
					<input class="select-type-telephone customize-table-ipt d-bd-none unselectable" disabled value="${typeValue}"" />
				</td>
				<td class="data-cell td-customize-new">
					<textarea rows="4" cols="50" class="ipt-obs customize-table-ipt" disabled>${obsValue}</textarea>
				</td>
				<td colspan="5" style="border: none !important">
					<button class="btn btn-remove-telephone">
						<svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="currentColor" class="bi bi-x-circle" viewBox="0 0 16 16">
						  <path d="M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z"/>
						  <path d="M4.646 4.646a.5.5 0 0 1 .708 0L8 7.293l2.646-2.647a.5.5 0 0 1 .708.708L8.707 8l2.647 2.646a.5.5 0 0 1-.708.708L8 8.707l-2.646 2.647a.5.5 0 0 1-.708-.708L7.293 8 4.646 5.354a.5.5 0 0 1 0-.708z"/>
						</svg>
					</button>
				</td>
			`;

		// Adiciona a nova linha à tbody
		document.querySelector(".new-rows-added").appendChild(newRow);

		// Criar um objeto JSON com os valores
		var telephoneObj = {
			telephone: telephoneValue,
			type: typeValue,
			obs: obsValue
		};

		// Adicionar o objeto ao array
		telephones.push(telephoneObj);

		// Limpa os campos
		document.querySelector("#add-phone-button").closest("tr").querySelector(".ipt-telephone").value = "";
		document.querySelector("#add-phone-button").closest("tr").querySelector(".select-type-telephone").value = "null";
		document.querySelector("#add-phone-button").closest("tr").querySelector(".ipt-obs").value = "";

		// Adicionar o evento de remoção ao botão
		var removeButton = newRow.querySelector(".btn-remove-telephone");
		removeButton.addEventListener("click", function () {
			// Encontre o índice do telefone no array telefones
			var index = telephones.indexOf(telephoneObj);

			// Remova o telefone do array
			if (index !== -1)
			{
				telephones.splice(index, 1);
			}

			// Remova a linha da visualização
			newRow.remove();
		});
	}
</script>
